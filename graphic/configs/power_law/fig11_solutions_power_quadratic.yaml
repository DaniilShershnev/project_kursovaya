# Рис. 11: Решения s(t) и w(t) для степенной модели с квадратичной МФ
# Модель: ṡ = a·w^β - s·w^(β-α), ẇ = c[1 - w(1 + b·g(s))]
# МФ: g(s) = 1 + (hs)²

type: ode_time

curves:
  # w₀ = 0.02
  - equations: ["a \\cdot (w + 0.0001)^{\\beta} - s \\cdot (w + 0.0001)^{\\beta - \\alpha}", "c \\cdot (1 - w \\cdot (1 + b \\cdot (1 + (h \\cdot s)^2)))"]
    variable_names: [s, w]
    initial_conditions: [300, 0.02]
    params: {a: 170, alpha: 2, beta: 1, c: 0.3, b: 1.0e-12, h: 0.07}
    t_span: [0, 6]
    styles:
      - {color: "cyan", linestyle: "-", linewidth: 1.5, label: "s, w₀=0.02"}
      - {color: "cyan", linestyle: "--", linewidth: 1.5, label: "w, w₀=0.02", use_right_axis: true}

  # w₀ = 0.1
  - equations: ["a \\cdot (w + 0.0001)^{\\beta} - s \\cdot (w + 0.0001)^{\\beta - \\alpha}", "c \\cdot (1 - w \\cdot (1 + b \\cdot (1 + (h \\cdot s)^2)))"]
    variable_names: [s, w]
    initial_conditions: [300, 0.1]
    params: {a: 170, alpha: 2, beta: 1, c: 0.3, b: 1.0e-12, h: 0.07}
    t_span: [0, 6]
    styles:
      - {color: "black", linestyle: "-", linewidth: 1.5, label: "s, w₀=0.1"}
      - {color: "black", linestyle: "--", linewidth: 1.5, label: "w, w₀=0.1", use_right_axis: true}

  # w₀ = 0.3
  - equations: ["a \\cdot (w + 0.0001)^{\\beta} - s \\cdot (w + 0.0001)^{\\beta - \\alpha}", "c \\cdot (1 - w \\cdot (1 + b \\cdot (1 + (h \\cdot s)^2)))"]
    variable_names: [s, w]
    initial_conditions: [300, 0.3]
    params: {a: 170, alpha: 2, beta: 1, c: 0.3, b: 1.0e-12, h: 0.07}
    t_span: [0, 6]
    styles:
      - {color: "green", linestyle: "-", linewidth: 1.5, label: "s, w₀=0.3"}
      - {color: "green", linestyle: "--", linewidth: 1.5, label: "w, w₀=0.3", use_right_axis: true}

  # w₀ = 0.6
  - equations: ["a \\cdot (w + 0.0001)^{\\beta} - s \\cdot (w + 0.0001)^{\\beta - \\alpha}", "c \\cdot (1 - w \\cdot (1 + b \\cdot (1 + (h \\cdot s)^2)))"]
    variable_names: [s, w]
    initial_conditions: [300, 0.6]
    params: {a: 170, alpha: 2, beta: 1, c: 0.3, b: 1.0e-12, h: 0.07}
    t_span: [0, 6]
    styles:
      - {color: "blue", linestyle: "-", linewidth: 1.5, label: "s, w₀=0.6"}
      - {color: "blue", linestyle: "--", linewidth: 1.5, label: "w, w₀=0.6", use_right_axis: true}

  # w₀ = 0.9
  - equations: ["a \\cdot (w + 0.0001)^{\\beta} - s \\cdot (w + 0.0001)^{\\beta - \\alpha}", "c \\cdot (1 - w \\cdot (1 + b \\cdot (1 + (h \\cdot s)^2)))"]
    variable_names: [s, w]
    initial_conditions: [300, 0.9]
    params: {a: 170, alpha: 2, beta: 1, c: 0.3, b: 1.0e-12, h: 0.07}
    t_span: [0, 6]
    styles:
      - {color: "red", linestyle: "-", linewidth: 1.5, label: "s, w₀=0.9"}
      - {color: "red", linestyle: "--", linewidth: 1.5, label: "w, w₀=0.9", use_right_axis: true}

axes:
  xlim: [0, 4]
  ylim: [100, 500]
  xlabel: "t"
  ylabel: "s"

  dual_y_axis: true
  ylim_right: [0, 1]
  ylabel_right: "w"

  grid: true
  grid_style:
    alpha: 0.3
    linestyle: ":"
    linewidth: 0.8
    color: "gray"

output: "fig11_power_solutions_quadratic.svg"
